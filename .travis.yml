matrix:
  include:
  - stage: Test
    language: node_js
    node_js: 8.5.0
    install: yarn
    script: npm install && npm test -- -u
  - stage: Deploy Android
    language: android
    before_install: #1.1
      - nvm install 6
      - node --version
    install: #1.2
      - nvm install 9.11.2
      - npm install -g react-native-cli
      - npm install
      - react-native link
    android: #1.3
      components:
        - build-tools-23.0.1
        - android-23
        - extra-android-m2repository
        - extra-google-google_play_services
        - extra-google-m2repository
        - addon-google_apis-google-16
    script:
      - npm run ci #2
      - cd android && ./gradlew assembleRelease